DOCUMENTATION = "\n---\nmodule: win_psmodule_info\nshort_description: Gather information about PowerShell Modules\ndescription:\n  - Gather information about PowerShell Modules including information from PowerShellGet.\noptions:\n  name:\n    description:\n      - The name of the module to retrieve.\n      - Supports any wildcard pattern supported by C(Get-Module).\n      - If omitted then all modules will returned.\n    type: str\n    default: '*'\n  repository:\n    description:\n      - The name of the PSRepository the modules were installed from.\n      - This acts as a filter against the modules that would be returned based on the I(name) option.\n      - Modules that were not installed from a repository will not be returned if this option is set.\n      - Only modules installed from a registered repository will be returned.\n      - If the repository was re-registered after module installation with a new C(SourceLocation), this will not match.\n    type: str\nrequirements:\n  - C(PowerShellGet) module\nseealso:\n  - module: community.windows.win_psrepository_info\n  - module: community.windows.win_psscript_info\nauthor:\n  - Brian Scholer (@briantist)\n"
EXAMPLES = '\n- name: Get info about all modules on the system\n  community.windows.win_psmodule_info:\n\n- name: Get info about the ScheduledTasks module\n  community.windows.win_psmodule_info:\n    name: ScheduledTasks\n\n- name: Get info about networking modules\n  community.windows.win_psmodule_info:\n    name: Net*\n\n- name: Get info about all modules installed from the PSGallery repository\n  community.windows.win_psmodule_info:\n    repository: PSGallery\n  register: gallery_modules\n\n- name: Update all modules retrieved from above example\n  community.windows.win_psmodule:\n    name: "{{ item }}"\n    state: latest\n  loop: "{{ gallery_modules.modules | map(attribute=name) }}"\n\n- name: Get info about all modules on the system\n  community.windows.win_psmodule_info:\n  register: all_modules\n\n- name: Find modules installed from a repository that isn\'t registered now\n  set_fact:\n    missing_repository_modules: "{{\n      all_modules\n      | json_query(\'modules[?repository!=null && repository==repository_source_location].{name: name, version: version, repository: repository}\')\n      | list\n    }}"\n\n- debug:\n    var: missing_repository_modules\n'
RETURN = "\nmodules:\n  description:\n    - A list of modules (or an empty list is there are none).\n  returned: always\n  type: list\n  elements: dict\n  contains:\n    name:\n      description:\n        - The name of the module.\n      type: str\n      sample: PSReadLine\n    version:\n      description:\n        - The module version.\n      type: str\n      sample: 1.2.3\n    guid:\n      description:\n        - The GUID of the module.\n      type: str\n      sample: 74c9fd30-734b-4c89-a8ae-7727ad21d1d5\n    path:\n      description:\n        - The path to the module.\n      type: str\n      sample: 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\PKI\\PKI.psd1'\n    module_base:\n      description:\n        - The path that contains the module's files.\n      type: str\n      sample: 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\PKI'\n    installed_location:\n      description:\n        - The path where the module is installed.\n        - This should have the same value as C(module_base) but only has a value when the module was installed via PowerShellGet.\n      type: str\n      sample: 'C:\\Program Files\\WindowsPowerShell\\Modules\\posh-git\\0.7.1'\n    exported_aliases:\n      description:\n        - The aliases exported from the module.\n      type: list\n      elements: str\n      sample:\n        - glu\n        - slu\n    exported_cmdlets:\n      description:\n        - The cmdlets exported from the module.\n      type: list\n      elements: str\n      sample:\n        - Get-Certificate\n        - Get-PfxData\n    exported_commands:\n      description:\n        - All of the commands exported from the module. Includes functions, cmdlets, and aliases.\n      type: list\n      elements: str\n      sample:\n        - glu\n        - Get-LocalUser\n    exported_dsc_resources:\n      description:\n        - The DSC resources exported from the module.\n      type: list\n      elements: str\n      sample:\n        - xWebAppPool\n        - xWebSite\n    exported_format_files:\n      description:\n        - The format files exported from the module.\n      type: list\n      elements: path\n      sample:\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsCmdlets.Format.ps1xml'\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsConfig.Format.ps1xml'\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsClientPSProvider.Format.ps1xml'\n    exported_functions:\n      description:\n        - The functions exported from the module.\n      type: list\n      elements: str\n      sample:\n        - New-VirtualDisk\n        - New-Volume\n    exported_type_files:\n      description:\n        - The type files exported from the module.\n      type: list\n      elements: path\n      sample:\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsCmdlets.Types.ps1xml'\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsConfig.Types.ps1xml'\n        - 'C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\DnsClient\\DnsClientPSProvider.Types.ps1xml'\n    exported_variables:\n      description:\n        - The variables exported from the module.\n      type: list\n      elements: str\n      sample:\n        - GitPromptScriptBlock\n    exported_workflows:\n      description:\n        - The workflows exported from the module.\n      type: list\n      elements: str\n    access_mode:\n      description:\n        - The module's access mode. See U(https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.moduleaccessmode)\n      type: str\n      sample: ReadWrite\n    module_type:\n      description:\n        - The module's type. See U(https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.moduletype)\n      type: str\n      sample: Script\n    procoessor_architecture:\n      description:\n        - The module's processor architecture. See U(https://docs.microsoft.com/en-us/dotnet/api/system.reflection.processorarchitecture)\n      type: str\n      sample: Amd64\n    author:\n      description:\n        - The author of the module.\n      type: str\n      sample: Warren Frame\n    copyright:\n      description:\n        - The copyright of the module.\n      type: str\n      sample: '(c) 2016 Warren F. All rights reserved.'\n    company_name:\n      description:\n        - The company name of the module.\n      type: str\n      sample: Microsoft Corporation\n    description:\n      description:\n        - The description of the module.\n      type: str\n      sample: Provides cmdlets to work with local users and local groups\n    clr_version:\n      description:\n        - The CLR version of the module.\n      type: str\n      sample: '4.0'\n    compatible_ps_editions:\n      description:\n        - The PS Editions the module is compatible with.\n      type: list\n      elements: str\n      sample:\n        - Desktop\n    dependencies:\n      description:\n        - The modules required by this module.\n      type: list\n      elements: str\n    dot_net_framework_version:\n      description:\n        - The .Net Framework version of the module.\n      type: str\n      sample: '4.6.1'\n    file_list:\n      description:\n        - The files included in the module.\n      type: list\n      elements: path\n      sample:\n        - 'C:\\Program Files\\WindowsPowerShell\\Modules\\PowerShellGet\\1.6.0\\PSModule.psm1'\n        - 'C:\\Program Files\\WindowsPowerShell\\Modules\\PowerShellGet\\1.6.0\\PSGet.Format.ps1xml'\n        - 'C:\\Program Files\\WindowsPowerShell\\Modules\\PowerShellGet\\1.6.0\\PSGet.Resource.psd1'\n    help_info_uri:\n      description:\n        - The help info address of the module.\n      type: str\n      sample: 'https://go.microsoft.com/fwlink/?linkid=390823'\n    icon_uri:\n      description:\n        - The address of the icon of the module.\n      type: str\n      sample: 'https://raw.githubusercontent.com/powershell/psscriptanalyzer/master/logo.png'\n    license_uri:\n      description:\n        - The address of the license for the module.\n      type: str\n      sample: 'https://github.com/PowerShell/xPendingReboot/blob/master/LICENSE'\n    project_uri:\n      description:\n        - The address of the module's project.\n      type: str\n      sample: 'https://github.com/psake/psake'\n    repository_source_location:\n      description:\n        - The source location of the repository where the module was installed from.\n      type: str\n      sample: 'https://www.powershellgallery.com/api/v2'\n    repository:\n      description:\n        - The PSRepository where the module was installed from.\n        - This value is not historical. It depends on the PSRepositories that are registered now for the current user.\n        - The C(repository_source_location) must match the current source location of a registered repository to get a repository name.\n        - If there is no match, then this value will match C(repository_source_location).\n      type: str\n      sample: PSGallery\n    release_notes:\n      description:\n        - The module's release notes. This is a free text field and no specific format should be assumed.\n      type: str\n      sample: |\n        ## 1.4.6\n        - Update `HelpInfoUri` to point to the latest content\n\n        ## 1.4.5\n        - Bug fix for deadlock when getting parameters in an event\n\n        ## 1.4.4\n        - Bug fix when installing modules from private feeds\n    installed_date:\n      description:\n        - The date the module was installed.\n      type: str\n      sample: '2018-02-14T17:55:34.9620740-05:00'\n    published_date:\n      description:\n        - The date the module was published.\n      type: str\n      sample: '2017-03-15T04:18:09.0000000'\n    updated_date:\n      description:\n        - The date the module was last updated.\n      type: str\n      sample: '2019-12-31T09:20:02.0000000'\n    log_pipeline_execution_details:\n      description:\n        - Determines whether pipeline execution detail events should be logged.\n      type: bool\n    module_list:\n      description:\n        - A list of modules packaged with this module.\n        - This value is not often returned and the modules are not automatically processed.\n      type: list\n      elements: dict\n      contains:\n        name:\n          description:\n            - The name of the module.\n            - This may also be a path to the module file.\n          type: str\n          sample: '.\\WindowsUpdateLog.psm1'\n        guid:\n          description:\n            - The GUID of the module.\n          type: str\n          sample: 82fdb72c-ecc5-4dfd-b9d5-83cf6eb9067f\n        version:\n          description:\n            - The minimum version of the module.\n          type: str\n          sample: '2.0'\n        maximum_version:\n          description:\n            - The maximum version of the module.\n          type: str\n          sample: '2.9'\n        required_version:\n          description:\n            - The exact version of the module required.\n          type: str\n          sample: '3.1.4'\n    nested_modules:\n      description:\n        - A list of modules nested with and loaded into the scope of this module.\n        - This list contains full module objects, so each item can have all of the properties listed here, including C(nested_modules).\n      type: list\n      elements: dict\n    required_modules:\n      description:\n        - A list of modules required by this module.\n        - This list contains full module objects, so each item can have all of the properties listed here, including C(required_modules).\n        - These module objects may not contain full information however, so you may see different results than if you had directly queried the module.\n      type: list\n      elements: dict\n    required_assemblies:\n      description:\n        - A list of assemblies that the module requires.\n        - The values may be a simple name or a full path.\n      type: str\n      sample:\n        - Microsoft.Management.Infrastructure.CimCmdlets.dll\n        - Microsoft.Management.Infrastructure.Dll\n    package_management_provider:\n      description:\n        - If the module was installed from PowerShellGet, this is the package management provider used.\n      type: str\n      sample: NuGet\n    power_shell_host_name:\n      description:\n        - The name of the PowerShell host that the module requires.\n      type: str\n      sample: Windows PowerShell ISE Host\n    power_shell_host_version:\n      description:\n        - The version of the PowerShell host that the module requires.\n      type: str\n      sample: '1.1'\n    power_shell_version:\n      description:\n        - The minimum version of PowerShell that the module requires.\n      type: str\n      sample: '5.1'\n    prefix:\n      description:\n        - The default prefix applied to C(Verb-Noun) commands exported from the module, resulting in C(Verb-PrefixNoun) names.\n      type: str\n    private_data:\n      description:\n        - Arbitrary private data used by the module. This is typically defined in the module manifest.\n        - This module limits the depth of the data returned for module types other than C(Script) and C(Manifest).\n        - The C(PSData) is commonly supplied and provides metadata for PowerShellGet but those fields are surfaced in top-level properties as well.\n      type: dict\n      sample:\n        PSData:\n          LicenseUri: https://example.com/module/LICENSE\n          ProjectUri: https://example.com/module/\n          ReleaseNotes: |\n            v2 - Fixed some bugs\n            v1 - First release\n          Tags:\n            - networking\n            - serialization\n    root_module:\n      description:\n        - The root module as defined in the manifest.\n        - This may be a module name, filename, or full path.\n      type: str\n      sample: WindowsErrorReporting.psm1\n    scripts:\n      description:\n        - A list of scripts (C(.ps1) files) that run in the caller's session state when the module is imported.\n        - This value comes from the C(ScriptsToProcess) field in the module's manifest.\n      type: list\n      sample:\n        - PrepareEnvironment.ps1\n        - InitializeData.ps1\n    tags:\n      description:\n        - The tags defined in the module's C(PSData) metadata.\n      type: list\n      elements: str\n      sample:\n        - networking\n        - serialization\n        - git\n        - dsc\n"