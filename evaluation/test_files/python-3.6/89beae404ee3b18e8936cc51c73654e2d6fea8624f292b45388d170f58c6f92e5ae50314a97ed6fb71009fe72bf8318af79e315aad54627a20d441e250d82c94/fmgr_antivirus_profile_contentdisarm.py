from __future__ import absolute_import, division, print_function
__metaclass__ = type
ANSIBLE_METADATA = {'status': ['preview'], 'supported_by': 'community', 'metadata_version': '1.1'}
DOCUMENTATION = '\n---\nmodule: fmgr_antivirus_profile_contentdisarm\nshort_description: no description\ndescription:\n    - This module is able to configure a FortiManager device.\n    - Examples include all parameters and values which need to be adjusted to data sources before usage.\n\nversion_added: "1.0.0"\nauthor:\n    - Link Zheng (@chillancezen)\n    - Jie Xue (@JieX19)\n    - Frank Shen (@fshen01)\n    - Hongbin Lu (@fgtdev-hblu)\nnotes:\n    - Running in workspace locking mode is supported in this FortiManager module, the top\n      level parameters workspace_locking_adom and workspace_locking_timeout help do the work.\n    - To create or update an object, use state present directive.\n    - To delete an object, use state absent directive.\n    - Normally, running one module can fail when a non-zero rc is returned. you can also override\n      the conditions to fail or succeed with parameters rc_failed and rc_succeeded\n\noptions:\n    enable_log:\n        description: Enable/Disable logging for task\n        required: false\n        type: bool\n        default: false\n    proposed_method:\n        description: The overridden method for the underlying Json RPC request\n        required: false\n        type: str\n        choices:\n          - update\n          - set\n          - add\n    bypass_validation:\n        description: |\n          only set to True when module schema diffs with FortiManager API structure,\n           module continues to execute without validating parameters\n        required: false\n        type: bool\n        default: false\n    workspace_locking_adom:\n        description: |\n          the adom to lock for FortiManager running in workspace mode, the value can be global and others including root\n        required: false\n        type: str\n    workspace_locking_timeout:\n        description: the maximum time in seconds to wait for other user to release the workspace lock\n        required: false\n        type: int\n        default: 300\n    state:\n        description: the directive to create, update or delete an object\n        type: str\n        required: true\n        choices:\n          - present\n          - absent\n    rc_succeeded:\n        description: the rc codes list with which the conditions to succeed will be overriden\n        type: list\n        required: false\n    rc_failed:\n        description: the rc codes list with which the conditions to fail will be overriden\n        type: list\n        required: false\n    adom:\n        description: the parameter (adom) in requested url\n        type: str\n        required: true\n    profile:\n        description: the parameter (profile) in requested url\n        type: str\n        required: true\n    antivirus_profile_contentdisarm:\n        description: the top level parameters set\n        required: false\n        type: dict\n        suboptions:\n            cover-page:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            detect-only:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-embed:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-hylink:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-linked:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-macro:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            original-file-destination:\n                type: str\n                description: no description\n                choices:\n                    - \'fortisandbox\'\n                    - \'quarantine\'\n                    - \'discard\'\n            pdf-act-form:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-act-gotor:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-act-java:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-act-launch:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-act-movie:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-act-sound:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-embedfile:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-hyperlink:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            pdf-javacode:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-action:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            office-dde:\n                type: str\n                description: no description\n                choices:\n                    - \'disable\'\n                    - \'enable\'\n            error-action:\n                type: str\n                description: no description\n                choices:\n                    - \'block\'\n                    - \'log-only\'\n                    - \'ignore\'\n\n'
EXAMPLES = '\n - hosts: fortimanager-inventory\n   collections:\n     - fortinet.fortimanager\n   connection: httpapi\n   vars:\n      ansible_httpapi_use_ssl: True\n      ansible_httpapi_validate_certs: False\n      ansible_httpapi_port: 443\n   tasks:\n    - name: no description\n      fmgr_antivirus_profile_contentdisarm:\n         bypass_validation: False\n         workspace_locking_adom: <value in [global, custom adom including root]>\n         workspace_locking_timeout: 300\n         rc_succeeded: [0, -2, -3, ...]\n         rc_failed: [-2, -3, ...]\n         adom: <your own value>\n         profile: <your own value>\n         antivirus_profile_contentdisarm:\n            cover-page: <value in [disable, enable]>\n            detect-only: <value in [disable, enable]>\n            office-embed: <value in [disable, enable]>\n            office-hylink: <value in [disable, enable]>\n            office-linked: <value in [disable, enable]>\n            office-macro: <value in [disable, enable]>\n            original-file-destination: <value in [fortisandbox, quarantine, discard]>\n            pdf-act-form: <value in [disable, enable]>\n            pdf-act-gotor: <value in [disable, enable]>\n            pdf-act-java: <value in [disable, enable]>\n            pdf-act-launch: <value in [disable, enable]>\n            pdf-act-movie: <value in [disable, enable]>\n            pdf-act-sound: <value in [disable, enable]>\n            pdf-embedfile: <value in [disable, enable]>\n            pdf-hyperlink: <value in [disable, enable]>\n            pdf-javacode: <value in [disable, enable]>\n            office-action: <value in [disable, enable]>\n            office-dde: <value in [disable, enable]>\n            error-action: <value in [block, log-only, ignore]>\n\n'
RETURN = '\nrequest_url:\n    description: The full url requested\n    returned: always\n    type: str\n    sample: /sys/login/user\nresponse_code:\n    description: The status of api request\n    returned: always\n    type: int\n    sample: 0\nresponse_message:\n    description: The descriptive message of the api response\n    type: str\n    returned: always\n    sample: OK.\n\n'
from ansible.module_utils.basic import AnsibleModule
from ansible.module_utils.connection import Connection
from ansible_collections.fortinet.fortimanager.plugins.module_utils.napi import NAPIManager
from ansible_collections.fortinet.fortimanager.plugins.module_utils.napi import check_galaxy_version
from ansible_collections.fortinet.fortimanager.plugins.module_utils.napi import check_parameter_bypass

def main():
    jrpc_urls = ['/pm/config/adom/{adom}/obj/antivirus/profile/{profile}/content-disarm', '/pm/config/global/obj/antivirus/profile/{profile}/content-disarm']
    perobject_jrpc_urls = ['/pm/config/adom/{adom}/obj/antivirus/profile/{profile}/content-disarm/{content-disarm}', '/pm/config/global/obj/antivirus/profile/{profile}/content-disarm/{content-disarm}']
    url_params = ['adom', 'profile']
    module_primary_key = None
    module_arg_spec = {'enable_log': {'type': 'bool', 'required': False, 'default': False}, 'forticloud_access_token': {'type': 'str', 'required': False, 'no_log': True}, 'proposed_method': {'type': 'str', 'required': False, 'choices': ['set', 'update', 'add']}, 'bypass_validation': {'type': 'bool', 'required': False, 'default': False}, 'workspace_locking_adom': {'type': 'str', 'required': False}, 'workspace_locking_timeout': {'type': 'int', 'required': False, 'default': 300}, 'rc_succeeded': {'required': False, 'type': 'list'}, 'rc_failed': {'required': False, 'type': 'list'}, 'adom': {'required': True, 'type': 'str'}, 'profile': {'required': True, 'type': 'str'}, 'antivirus_profile_contentdisarm': {'required': False, 'type': 'dict', 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'options': {'cover-page': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'detect-only': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-embed': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-hylink': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-linked': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-macro': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'original-file-destination': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['fortisandbox', 'quarantine', 'discard'], 'type': 'str'}, 'pdf-act-form': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-act-gotor': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-act-java': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-act-launch': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-act-movie': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-act-sound': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-embedfile': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-hyperlink': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'pdf-javacode': {'required': False, 'revision': {'6.0.0': True, '6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-action': {'required': False, 'revision': {'6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'office-dde': {'required': False, 'revision': {'6.2.1': True, '6.2.3': True, '6.2.5': True, '6.4.0': True, '6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['disable', 'enable'], 'type': 'str'}, 'error-action': {'required': False, 'revision': {'6.4.2': True, '6.4.5': True, '7.0.0': True, '7.2.0': True}, 'choices': ['block', 'log-only', 'ignore'], 'type': 'str'}}}}
    params_validation_blob = []
    check_galaxy_version(module_arg_spec)
    module = AnsibleModule(argument_spec=check_parameter_bypass(module_arg_spec, 'antivirus_profile_contentdisarm'), supports_check_mode=False)
    fmgr = None
    if module._socket_path:
        connection = Connection(module._socket_path)
        connection.set_option('enable_log', module.params['enable_log'] if 'enable_log' in module.params else False)
        connection.set_option('forticloud_access_token', module.params['forticloud_access_token'] if 'forticloud_access_token' in module.params else None)
        fmgr = NAPIManager(jrpc_urls, perobject_jrpc_urls, module_primary_key, url_params, module, connection, top_level_schema_name='data')
        fmgr.validate_parameters(params_validation_blob)
        fmgr.process_partial_curd(argument_specs=module_arg_spec)
    else:
        module.fail_json(msg='MUST RUN IN HTTPAPI MODE')
    module.exit_json(meta=module.params)
if __name__ == '__main__':
    main()